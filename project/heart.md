# π© house_price_regression

## μ‹¬μ¥λ§λΉ„ λ¶„λ¥

### https://www.kaggle.com/datasets/rashikrahmanpritom/heart-attack-analysis-prediction-dataset

## Features

- age - λ‚μ΄
- sex - μ„±λ³„
- cp - ν‰ν†µ μΆ…λ¥
- trtbps - μ•μ •μ‹ νμ••
- chol - μ½λ μ¤ν…λ΅¤
- fbs - κ³µλ³µνλ‹Ή
- restecg - ν΄μ‹μ¤‘ μ‹¬μ „λ„ κ²°κ³Ό
- thalachh - μµλ€μ‹¬λ°•μ
- exng - ν‘μ‹¬μ¦
- oldpeak - μ΄λ™λ¶€ν•
- slp - μ‹¬μ¥ μ „κΈ°ν™λ™
- caa - μ£Όμ” νκ΄€ μ
- thall - λ°©μ‚¬μ„± λ™μ„μ›μ†
- output - μ‹¬μ¥λ§λΉ„ μ—¬λ¶€(target)

### 1. λ°μ΄ν„° ν™•μΈ

- info(), duplicated(), isna()λ¥Ό ν†µν•΄ μλ£ν•, μ¤‘λ³µν–‰, κ²°μΈ΅μΉλ¥Ό ν™•μΈν•μ€μ„λ•,  
  1κ°μ μ¤‘λ³µν–‰μ„ ν™•μΈν•μ€κ³  μ κ±°ν•μ€μµλ‹λ‹¤.

- μ΄μ§„λ¶„λ¥ λ°μ΄ν„°μ΄λ©°, λ¨λ“  ν”Όμ³λ” μμΉν•μ΄λΌλ”κ²ƒμ„ ν™•μΈν•μ€μµλ‹λ‹¤.

- νμ¤ν† κ·Έλ¨ ν™•μΈ
  <img src='./images/heart_hist01.png'>

- κ· ν•μ΄ λ§μ§€μ•λ” ν”Όμ³λ“¤μ΄ λ§μ΄ λ³΄μ…λ‹λ‹¤. νƒ€κ²ν”Όμ³μ λΉ„μ¨μ€ ν¬κ² μ°¨μ΄κ°€ λ‚μ§€ μ•μ§€λ§ μ΅°κΈμ μ°¨μ΄κ°€ λ‚λ”κ²ƒμ„ ν™•μΈν–μµλ‹λ‹¤.

### 2. μ „μ²λ¦¬

- μ°¨μ›μ¶•μ†λ¥Ό μ§„ν–‰ν•κΈ° μ„ν•΄ λ‹¤μ¤‘κ³µμ„ μ„± ν™•μΈν•λ©° μ „μ²λ¦¬.

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vif_score</th>
      <th>feature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39.567644</td>
      <td>age</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.507112</td>
      <td>sex</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.409980</td>
      <td>cp</td>
    </tr>
    <tr>
      <th>3</th>
      <td>58.776923</td>
      <td>trtbps</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26.281421</td>
      <td>chol</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.273256</td>
      <td>fbs</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2.051037</td>
      <td>restecg</td>
    </tr>
    <tr>
      <th>7</th>
      <td>42.631809</td>
      <td>thalachh</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2.022825</td>
      <td>exng</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3.071361</td>
      <td>oldpeak</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10.015857</td>
      <td>slp</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.860512</td>
      <td>caa</td>
    </tr>
    <tr>
      <th>12</th>
      <td>17.141073</td>
      <td>thall</td>
    </tr>
  </tbody>
</table>

- μ „μ²λ¦¬ μ—†μ΄ ν™•μΈν• vifμ—μ„ μƒλ€μ μΌλ΅ λ†’μ€ μμΉλ“¤μ΄ μ—¬λ¬κ° ν™•μΈλμ—μµλ‹λ‹¤.  
  ν•λ‚μ”© μ κ±°ν•΄λ³Έ ν›„ κ²°κ³Όκ°€ μ λ‹Ήν•΄μ§„ μ‹μ μ—μ„ μ§„ν–‰ν•μ€μµλ‹λ‹¤.

- trtbpsμ vifμ¤μ½”μ–΄κ°€ κ°€μ¥ λ†’μ•„μ„ ν™•μΈν•΄λ³΄μ•μΌλ‚ λ‹¤λ¥Έν”Όμ³μ™€μ μƒκ΄€κ΄€κ³„κ°€ λ‚®μ•„ λ‹¤μμΌλ΅  
  vifμ¤μ½”μ–΄κ°€ λ†’μ€ thalachhλ¥Ό ν™•μΈν•΄λ³΄μ•λ”λ° λ‡κ°μ λ…λ¦½λ³€μλ“¤κ³Όμ μƒκ΄€κ΄€κ³„κ°€  
   0.4κ°€κΉμ΄ λλ”κ²ƒμ„ ν™•μΈν•μ€μµλ‹λ‹¤.  
   ν•μ§€λ§ thalachh μμ²΄λ” νƒ€κ²κ³Όμ κ΄€κ³„κ°€ λ†’μ€νΈμ΄λΌ  
   thalachhμ™€ κ΄€κ³„κ°€ ν¬κ³  νƒ€κ²κ³Όμ κ΄€κ³„κ°€ μ‘μ€ ageν”Όμ³λ¥Ό μ κ±°ν•©λ‹λ‹¤.

- λ‹¤μμΌλ΅λ” νƒ€κ²κ³Όμ μƒκ΄€κ΄€κ³„κ°€ 0.1λ„ λμ§€μ•λ” fbsμ™€ cholν”Όμ³λ¥Ό μ κ±°ν• ν›„ vifλ¥Ό ν™•μΈν•΄λ³΄λ‹

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vif_score</th>
      <th>feature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.365299</td>
      <td>sex</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.364969</td>
      <td>cp</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36.863315</td>
      <td>trtbps</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.018949</td>
      <td>restecg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>39.287291</td>
      <td>thalachh</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.996700</td>
      <td>exng</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3.016282</td>
      <td>oldpeak</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9.814842</td>
      <td>slp</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.726323</td>
      <td>caa</td>
    </tr>
    <tr>
      <th>9</th>
      <td>16.248407</td>
      <td>thall</td>
    </tr>
  </tbody>
</table>

- μ—¬μ „ν 30μ΄ λ„λ” ν”Όμ³κ°€ μμ–΄μ„  
  νƒ€κ²κ³Όμ μƒκ΄€κ΄€κ³„κ°€ 0.2μ΄ν•μΈ λ‘ ν”Όμ³ μ¤‘ λ‹¤λ¥Έ λ…λ¦½λ³€μλ“¤κ³Όμ κ΄€κ³„κ°€ μ΅°κΈ λ” ν° trtbpsν”Όμ³λ¥Ό μ κ±°ν•μ€μµλ‹λ‹¤.

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vif_score</th>
      <th>feature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.357678</td>
      <td>sex</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.333443</td>
      <td>cp</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.018568</td>
      <td>restecg</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22.834630</td>
      <td>thalachh</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.906363</td>
      <td>exng</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.781007</td>
      <td>oldpeak</td>
    </tr>
    <tr>
      <th>6</th>
      <td>9.721258</td>
      <td>slp</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.691469</td>
      <td>caa</td>
    </tr>
    <tr>
      <th>8</th>
      <td>15.140299</td>
      <td>thall</td>
    </tr>
  </tbody>
</table>

- μ κ±° ν›„ vifμ¤μ½”μ–΄λ” μ΄μ •λ„λ©΄ κ΄μ°®λ‹¤κ³  νλ‹¨λμ–΄ μ°¨μ›μ¶•μ†λ¥Ό μ§„ν–‰ν•μ€μµλ‹λ‹¤.

### 3. μ°¨μ›μ¶•μ†(LDA)

- μ΄μ§„λ¶„λ¥ λ°μ΄ν„°κΈ°λ•λ¬Έμ— 1μ°¨μ›μΌλ΅ μ¶•μ† ν›„ μ§„ν–‰ν•μ€μµλ‹λ‹¤.

- pytorchλ¥Ό μ‚¬μ©ν•μ—¬ logistic νκ·€λ¥Ό μ§„ν–‰ν•μ€μ„ λ•  
  μ •ν™•λ„: 0.8852, μ •λ°€λ„: 0.8421, μ¬ν„μ¨: 0.9697, F1: 0.9014, ROC-AUC: 0.8777  
  λΌλ” μΆ‹μ€ μμΉκ°€ λ‚μ™”μµλ‹λ‹¤.

- κΈ°λ³Έμ μΈ λ¶„λ¥ λ¨λΈμΈ DecisionTreeClassifierλ¥Ό μ‚¬μ©ν•μ—¬ export_graphvizμ νΈλ¦¬ μ‹κ°ν™”λ¥Ό ν†µν•΄  
  μ–΄λμ •λ„μ depthμ™€ leafλ¥Ό ν™•μΈν•΄λ³΄μ•μµλ‹λ‹¤.
  <img src='./images/hearts01.png'>

- μ•„λλ” μ—¬λ¬κ°μ λ¨λΈμ„ μ‚¬μ©ν•μ—¬ ν…μ¤νΈ ν• κ²°κ³Όμ…λ‹λ‹¤
- rfc = RandomFrestClassifier
- gbc = GradientBoostingClassifier
- xgb = XGBClassifier
- lgbm = LGBMClassifier
- logist = LogisticRegression

<img src='./images/heart_models01.png'>

- λ³΄μ‹λ‹¤μ‹ν”Ό rfcμ™€ logisticλ¨λΈμ κ²°κ³Όκ°€ μ™„μ „ κ°™κ² λ‚νƒ€λ‚¬μΌλ©° κ°€μ¥ κ²°κ³Όκ°€ μΆ‹μ•μµλ‹λ‹¤.

### 4. μ„κ³„μΉ μ΅°μ •

#### μ‹¬μ¥λ³‘ λ¶„λ¥

> True Positive (TP): λ¨λΈμ΄ μ‹¬μ¥λ³‘μ„ μ‹¬μ¥λ³‘μΌλ΅ λ¶„λ¥ν• κ²½μ°  
> False Positive (FP): λ¨λΈμ΄ μ‹¬μ¥λ³‘μ„ μ •μƒμΌλ΅ μλ» λ¶„λ¥ν• κ²½μ°  
> True Negative (TN): λ¨λΈμ΄ μ •μƒμΈμ„ μ •μƒμΌλ΅ μ¬λ°”λ¥΄κ² λ¶„λ¥ν• κ²½μ°  
> False Negative (FN): λ¨λΈμ΄ μ •μƒμΈμ„ μ‹¬μ¥λ³‘μΌλ΅ μλ» λ¶„λ¥ν• κ²½μ°

- μ‹¬μ¥λ³‘ ν™μλ¥Ό μ •μƒμΌλ΅ νλ‹¨ν•μ—¬ μ¤μ§„ μ‹ μΉλ£λ¥Ό λ°›μ§€ λ»ν•΄ λ¬Έμ κ°€ μƒκΈ°μ§€λ§,  
  μ •μƒμΈμ—κ² μ‹¬μ¥λ³‘μ΄λΌκ³  μ¤μ§„ μ‹ ν™μκ°€ λ‹ΉνΉμ¤λ½κΈ΄ ν•μ—¬λ„  
  μ¬κ²€μ‚¬ μ‹ μ •μƒμ„μ„ ν™•μΈν•κ³  λλ‚Ό μ μκΈ° λ•λ¬Έμ΄λΌ νλ‹¨ν•μ€μµλ‹λ‹¤.

- λ”°λΌμ„ μ„κ³„μΉλ¥Ό λ†’μ—¬ μ •λ°€λ„λ¥Ό μ¬λ ¤μ£Όλ” κ²ƒμ΄ μ ν•©ν•λ‹¤κ³  μƒκ°ν•μ€μµλ‹λ‹¤.

- Logistic_Regressionμ— predict_probaλ¥Ό ν†µν•΄ μμΈ΅ ν™•λ¥ μ„ λ°›μ•„ κ° μ„κ³„μΉμ— λ€ν• μ •λ°€λ„μ™€ μ¬ν„μ¨λ“±μ„ λ°ν™λ°›κ³ 
- κ°€μ¥ μ μ ν• μ¤μ½”μ–΄λ“±μ„ μ‚¬μ©ν•΄ μ„κ³„μΉλ¥Ό μ •ν•©λ‹λ‹¤.

- μ„κ³„μΉκ°€ 0.6057029604334261μΌλ• μ •λ°€λ„κ°€ λ”± 0.90μ΄ λμ–΄μ„ ν•΄λ‹Ή μ„κ³„μΉλ¥Ό μ΄μ©ν• μ¤μ°¨ν–‰λ ¬κ³Ό κ° μμΉλ“¤μ„ ν™•μΈν•μ€μµλ‹λ‹¤.

μ •ν™•λ„: 0.8525, μ •λ°€λ„: 0.9000, μ¬ν„μ¨: 0.8182, F1: 0.8571, ROC-AUC: 0.8555
<img src='./images/heart_eva03.png'>

μ •λ°€λ„μ™€ μ¬ν„μ¨ κ·Έλν”„

<img src='./images/heart_pre_recall_curve.png'>

- μ„κ³„μΉκ°€ 0.56 ~ 0.66μ‚¬μ΄κ°€ μ μ ν•λ‹¤λ”κ²ƒμ„ ν™•μΈν•μ€μµλ‹λ‹¤.

roc-curve

<img src='./images/roc_curve01.png'>

- λ°μ΄ν„°μ κ°―μκ°€ μ μ–΄ κ·Έλν”„κ°€ λλ κΊΎμ΄μ§€λ§, κ½¤λ‚ μ΄μƒμ μΈ ν•νƒμ…λ‹λ‹¤.

### κ²°λ΅ 

- vifμ¤μ½”μ–΄λ¥Ό ν™•μΈν•μ—¬ λ‹¤μ¤‘κ³µμ„ μ„±μ„ μ–΄λμ •λ„ μ κ±°ν• ν›„ LDAλ¥Ό ν†µν•΄ μ°¨μ›μ¶•μ†λ¥Ό ν•κ³  logistic νκ·€λ¥Ό ν†µν•΄  
  λ‚μ¨ κ²°κ³Όμ— μ„κΌμΉλ¥Ό μ΅°μ •ν•μ—¬ μ›ν•λλ€λ΅ μ •λ°€λ„λ¥Ό λ†’μ—¬μ£Όμ—κ³ , μ‹κ°ν™”λ¥Όν†µν•΄ μ μ ν• μ„κ³„μΉλ¥Ό μ£Όμ—λ‹¤λ”κ²ƒλ„ ν™•μΈν•μ€μµλ‹λ‹¤.

- κ²°κ³Όμ μΌλ΅  
  μ •ν™•λ„: 0.8525, μ •λ°€λ„: 0.9000, μ¬ν„μ¨: 0.8182, F1: 0.8571, ROC-AUC: 0.8555μ μΆ‹μ€ μμΉλ¥Ό λ³΄μ—¬μ£Όμ–΄  
  κ°€μ¥ μ μ ν•λ‹¤κ³  μƒκ°λλ” Logistic_regression λ¨λΈμ— μ„κ³„μΉ μ΅°μ •κΉμ§€ μ„±κ³µμ μ΄μ—λ‹¤κ³  μƒκ°λ©λ‹λ‹¤.
